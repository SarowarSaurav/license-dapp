{"version":3,"sources":["utils/hex.js","components/Home.js","utils/getWeb3.js","utils/getContractInstance.js","components/Certification.js","utils/sendTransaction.js","components/IssuePage.js","components/App.js","index.js"],"names":["toHex","str","s","unescape","encodeURIComponent","h","i","length","charCodeAt","toString","fromHex","String","fromCharCode","parseInt","substr","decodeURIComponent","escape","Home","state","bride","groom","handleChange","e","setState","target","name","value","validation","this","canIssue","className","src","alt","width","height","type","placeholder","required","onChange","to","Component","getWeb3","Promise","resolve","reject","a","window","ethereum","web3","Web3","enable","console","log","provider","providers","HttpProvider","getContractInstance","contractDefinition","eth","net","getId","networkId","deployedAddress","networks","address","instance","Contract","abi","Certification","certificationID","txHash","issuedDate","Date","toLocaleDateString","componentDidMount","params","props","match","isSample","getAccounts","accounts","contract","id","decodeCertificationID","methods","certifications","call","from","certification","getTransactionReceipt","receipt","getBlock","blockNumber","block","replace","timestamp","alert","message","error","path","hex","Number","sendTransaction","transaction","estimateGas","gas","options","data","encodeABI","gasPrice","send","blockHash","IssuePage","issuing","issued","handleClick","location","href","padTo32byte","FEE","fee","issueCertification","events","Issued","returnValues","certificationId","transactionHash","readOnly","disabled","role","aria-hidden","onClick","padStart","App","component","ReactDOM","render","document","getElementById"],"mappings":"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","file":"static/js/main.7d4d442f.chunk.js","sourcesContent":["// Ref: https://gist.github.com/valentinkostadinov/5875467\nconst toHex = (str) => {\n    // utf8 to latin1\n    var s = unescape(encodeURIComponent(str))\n    var h = ''\n    for (var i = 0; i < s.length; i++) {\n        h += s.charCodeAt(i).toString(16)\n    }\n    return h\n}\n\nconst fromHex = (h) => {\n    var s = ''\n    for (var i = 0; i < h.length; i+=2) {\n        s += String.fromCharCode(parseInt(h.substr(i, 2), 16))\n    }\n\n    return decodeURIComponent(escape(s))\n}\n\nexport { toHex, fromHex }\n","import React, { Component } from \"react\"\nimport { Link } from \"react-router-dom\"\nimport { toHex } from \"../utils/hex\"\n\nclass Home extends Component {\n  state = {\n    bride: '',\n    groom: '',\n  }\n\n  handleChange = (e) => this.setState({[e.target.name]: toHex(e.target.value)})\n\n  validation = (value) => 1 <= value.length && value.length <= 64\n\n  render() {\n    let bride = this.state.bride\n    let groom = this.state.groom\n    let canIssue = this.validation(bride) && this.validation(groom)\n\n    return (\n      <div className=\"container ribbon14-wrapper\">\n        <span className=\"ribbon14\">â™¡</span>\n        <div className=\"py-5 text-center\">\n          <img className=\"d-block mx-auto mb-4\" src=\"/img/icon.png\" alt=\"\" width=\"72\" height=\"72\"/>\n          <h1 className=\"text-white\">Marriage certification on Blockchain</h1>\n          <p className=\"lead text-white\">Blockchain prove your marriage forever even you go. Issue marriage certification for everybody even sexual minorities.</p>\n        </div>\n        <form className=\"form-signin\">\n          <div className=\"text-center mb-4\">\n            <p className=\"lead text-white\">Please tell us <code className=\"p-1 bg-light\">your name</code> and <br/><code className=\"p-1 bg-light\">your partner's name</code>. We are going to show you a sample certification.</p>\n          </div>\n\n          <div className=\"form-label-group mb-2\">\n            <input type=\"text\" name=\"bride\" placeholder=\"Your Name\" required\n              onChange={(e) => this.handleChange(e)} \n              className={this.validation(bride) || bride === '' ? \"form-control\" : \"is-invalid form-control\"}/>\n            <div className=\"invalid-feedback text-white\">Too Long</div>\n          </div>\n\n          <div className=\"form-label-group mb-4\">\n            <input type=\"text\" name=\"groom\" placeholder=\"Partner's Name\" required\n              onChange={(e) => this.handleChange(e)} \n              className={this.validation(groom) || groom === '' ? \"form-control\" : \"is-invalid form-control\"}/>\n            <div className=\"invalid-feedback text-white\">Too Long</div>\n          </div>\n          <Link className={canIssue \n              ? 'btn btn-lg btn-block btn-outline-pink' \n              : 'btn btn-lg btn-block btn-outline-pink disabled'\n            } to={`/certification/sample/${bride}/${groom}`}>Issue Sample Certification</Link>\n        </form>\n      </div>\n    )\n  }\n}\n\nexport default Home;\n","import Web3 from \"web3\";\n\nconst getWeb3 = () =>\n  new Promise(async (resolve, reject) => {\n    // Wait for loading completion to avoid race conditions with web3 injection timing.\n    // window.addEventListener(\"load\", async () => {\n      // Modern dapp browsers...\n      if (window.ethereum) {\n        const web3 = new Web3(window.ethereum);\n\n        try {\n          // Request account access if needed\n          await window.ethereum.enable();\n          // Acccounts now exposed\n          resolve(web3);\n        } catch (error) {\n          reject(error);\n        }\n      }\n      // Legacy dapp browsers...\n      else if (window.web3) {\n        // Use Mist/MetaMask's provider.\n        const web3 = window.web3;\n        console.log(\"Injected web3 detected.\");\n        resolve(web3);\n      }\n      // Fallback to localhost; use dev console port by default...\n      else {\n        const provider = new Web3.providers.HttpProvider(\n          \"http://127.0.0.1:8545\"\n        );\n        const web3 = new Web3(provider);\n        console.log(\"No web3 instance injected, using Local web3.\");\n        resolve(web3);\n      }\n    // });\n  });\n\nexport default getWeb3;\n","const getContractInstance = async (web3, contractDefinition) => {\n\n  // get network ID and the deployed address\n  const networkId = await web3.eth.net.getId()\n  const deployedAddress = contractDefinition.networks[networkId].address\n\n  // create the instance\n  const instance = new web3.eth.Contract(contractDefinition.abi, deployedAddress)\n\n  return instance\n}\n\nexport default getContractInstance\n","import React, { Component } from \"react\";\nimport { Link } from \"react-router-dom\";\n\nimport contractDefinition from \"../contracts/MarriageCertificationIssuer.json\";\nimport getWeb3 from \"../utils/getWeb3\";\nimport getContractInstance from '../utils/getContractInstance'\nimport { redirectRoot } from \"../utils/common\";\nimport { toHex, fromHex } from \"../utils/hex\";\n\nconst PREFIX_NUM = 20000000;\n\nclass Certification extends Component {\n  state = {\n    bride: '',\n    groom: '',\n    certificationID: '0x00000',\n    txHash: '0x0000000000000000000000000000000000000000',\n    issuedDate: (new Date()).toLocaleDateString('en-US'),\n  }\n\n  componentDidMount = async () => {\n    const params = this.props.match.params\n\n    if (this.isSample()) {\n      this.setState({ bride: fromHex(params.bride), groom: fromHex(params.groom) })\n      return\n    }\n\n    try {\n      const web3 = await getWeb3()\n      const accounts = await web3.eth.getAccounts()\n      const contract = await getContractInstance(web3, contractDefinition)\n\n      const id = decodeCertificationID(params.id)\n      const certification = await contract.methods.certifications(id).call({ from: accounts[0] })\n      const receipt = await web3.eth.getTransactionReceipt(params.txHash)\n      const block = await web3.eth.getBlock(receipt.blockNumber)\n\n      this.setState({ \n        bride: fromHex(certification.bride.replace(/^0x0*/,'')),\n        groom: fromHex(certification.groom.replace(/^0x0*/,'')),\n        certificationID: params.id,\n        txHash: params.txHash,\n        issuedDate: (new Date(block.timestamp * 1000)).toLocaleDateString('en-US'),\n      })\n\n    } catch (e) {\n      alert(e.message, console.error(e));\n    }\n  }\n\n  isSample = () => this.props.match.path === '/certification/sample/:bride/:groom/'\n\n  render() {\n    const isSample = this.isSample()\n    return (\n      <div className=\"bg-white\">\n        <div className=\"container py-5\">\n          <div className=\"cross-line text-center my-2 mx-2\">\n            <div className=\"row mt-3\">\n              <div className=\"col\">\n                <img className=\"d-block mx-auto mb-4\" src=\"/img/gorgeous-line-top.png\" alt=\"\" width=\"300\" height=\"50\"/>\n                { isSample ? <h3>Sample</h3> : ''}\n                <h1 className=\"text-pink\">Certificate of Marriage</h1>\n              </div>\n            </div>\n            <div className=\"row\">\n              <div className=\"col-md-5\">\n                <p className=\"lead mx-4 border-line\">{this.state.bride}</p>\n              </div>\n              <div className=\"col-md-2\">\n                <p>And</p>\n              </div>\n              <div className=\"col-md-5\">\n                <p className=\"lead mx-4 border-line\">{this.state.groom}</p>\n              </div>\n            </div>\n            <div className=\"row\">\n              <div className=\"col\">\n                <p>Were United in Marriage on <code className=\"border-line text-dark\">{this.state.issuedDate}</code><br/>This Certification was Recored in a Smart Contract of Ethereum.</p>\n              </div>\n            </div>\n            <div className=\"row mb-5\">\n              <div className=\"col-md-1\"></div>\n              <div className=\"col-md-8 text-left\">\n                <blockquote className=\"blockquote ml-2\">\n                  <p className=\"mb-0\">Transaction Hash:</p>\n                  <footer className=\"blockquote-footer break-word\">{this.state.txHash}</footer>\n                </blockquote>\n                <blockquote className=\"blockquote ml-2\">\n                  <p className=\"mb-0\">Certification ID:</p>\n                  <footer className=\"blockquote-footer break-word\">{this.state.certificationID}</footer>\n                </blockquote>\n              </div>\n              <div className=\"col-md-2\">\n                <img src=\"/img/certification-stamp.png\" alt=\"Responsive image\" width=\"130\" height=\"150\"/>\n              </div>\n              <div className=\"col-md-1\"></div>\n            </div>\n            <div className=\"row\">\n              <div className=\"col\">\n                <img className=\"d-block mx-auto mb-4\" src=\"/img/gorgeous-line-bottom.png\" alt=\"\" width=\"270\" height=\"30\"/>\n              </div>\n            </div>\n          </div>\n        </div>\n\n        <div className=\"pink lighten-1\">\n          <div className=\"container\">\n            <div className=\"row text-white\">\n              <div className=\"col\">\n                <p className=\"lead my-1\">Share with your partner</p>\n                <nav className=\"mb-2\">\n                  <img className=\"mr-2\" src=\"/img/facebook-icon.svg\" alt=\"\" width=\"30\" height=\"30\"/>\n                  <img className=\"mr-2\" src=\"/img/twitter-icon.svg\" alt=\"\" width=\"30\" height=\"30\"/>\n                  <img className=\"mr-2\" src=\"/img/mail-icon.svg\" alt=\"\" width=\"30\" height=\"30\"/>\n                </nav>\n              </div>\n            </div>\n            { isSample\n              ? <div className=\"row mb-2\">\n                  <div className=\"col\">\n                    <Link className=\"btn btn-lg btn-block btn-outline-pink\" \n                      to={`/issue/${toHex(this.state.bride)}/${toHex(this.state.groom)}`}>Next</Link>\n                  </div>\n                </div>\n              : ''\n             }\n          </div>\n        </div>\n      </div>\n    )\n  }\n}\n\nconst decodeCertificationID = (hex) => Number(fromHex(hex.replace(/^0x/, \"\"))) - PREFIX_NUM - 1\n\nexport default Certification;\n","const sendTransaction = async (transaction, from, value=0, web3) => {\n  const gas = await transaction.estimateGas({ from, value })\n\n  console.log(\"Estimaged Gas:\" + gas)\n  console.log(transaction)\n\n  let options = {\n    from,\n    data: transaction.encodeABI(),\n    gas: gas + 10000,\n    gasPrice: 10000000000,\n    value\n  }\n\n  const receipt = await transaction.send(options)\n\n  console.log(receipt)\n\n  if (!receipt.blockHash) throw 'Failed to send transaction'\n\n  return receipt;\n}\n\nexport default sendTransaction\n","import React, { Component } from \"react\";\nimport { redirectRoot } from \"../utils/common\";\n\nimport contractDefinition from \"../contracts/MarriageCertificationIssuer.json\";\nimport getWeb3 from \"../utils/getWeb3\";\nimport getContractInstance from '../utils/getContractInstance'\nimport sendTransaction from '../utils/sendTransaction'\nimport { toHex, fromHex } from \"../utils/hex\";\n\nclass IssuePage extends Component {\n  state = {\n    issuing: false,\n    issued: false,\n    bride: '',\n    groom: '',\n    certificationID: '',\n    txHash: '',\n  }\n\n  componentDidMount() {\n    const params = this.props.match.params\n    this.setState({bride: params.bride, groom: params.groom})\n  }\n\n  handleChange = (e) => this.setState({[e.target.name]: toHex(e.target.value)})\n\n  handleClick = async () => {\n    if (this.state.issued) {\n      const s = this.state\n      window.location.href = `/certification/${s.certificationID}/${s.txHash}`\n    }\n\n    try {\n      this.setState({issuing: true})\n      const web3 = await getWeb3()\n      const accounts = await web3.eth.getAccounts()\n      const contract = await getContractInstance(web3, contractDefinition)\n\n      const bride = padTo32byte(this.state.bride)\n      const groom = padTo32byte(this.state.groom)\n      const fee = await contract.methods.FEE().call({ from: accounts[0] })\n\n      const transaction = contract.methods.issueCertification(bride, groom)\n      const receipt = await sendTransaction(transaction, accounts[0], fee)\n\n      this.setState({ \n        issued: true, \n        issuing: false, \n        certificationID: `0x${toHex(receipt.events.Issued.returnValues.certificationId)}`, \n        txHash: receipt.transactionHash\n      })\n\n    } catch (e) {\n      this.setState({issuing: false})\n      alert(e.message, console.error(e));\n    }\n  }\n\n  render() {\n    return (\n      <div className=\"container\">\n        <div className=\"py-4 text-center\">\n          <h1 className=\"text-white\">Issue Real Marriage certification</h1>\n        </div>\n        <form className=\"form-signin\">\n          <div className=\"text-left mb-4\">\n            <p className=\"lead text-white\">Confirm your and your partner's name.</p>\n          </div>\n          <div className=\"form-label-group mb-2\">\n            { this.state.issued || this.state.issuing\n              ? <input type=\"text\" className=\"form-control\" value={fromHex(this.state.bride)} readOnly/>\n              : <input type=\"text\" name=\"bride\" className=\"form-control\" \n                  value={fromHex(this.state.bride)} onChange={(e) => this.handleChange(e)} />\n            }\n          </div>\n          <div className=\"form-label-group mb-4\">\n            { this.state.issued || this.state.issuing\n              ? <input type=\"text\" className=\"form-control\" value={fromHex(this.state.groom)} readOnly/>\n              : <input type=\"text\" name=\"groom\" className=\"form-control\" \n                  value={fromHex(this.state.groom)} onChange={(e) => this.handleChange(e)} />\n            }\n          </div>\n          <div className=\"text-left mb-4\">\n            <p className=\"lead text-white\">We issue marriage certification on Ethereum and take <u>0.02</u> ETH as issuance fee. Please make sure that <a className=\"text-white\"href=\"https://metamask.io/\"><strong>MetaMask</strong></a> have installed and enough ETH have been deposited.</p>\n            <p className=\"lead text-white\">If you have prepared, we issue marriage certification for you. It may take few minutes. Be patient.</p>\n          </div>\n          { this.state.issuing\n            ? <button className = \"btn btn-lg btn-block btn-outline-pink mb-4\" disabled>\n                <span className=\"spinner-border spinner-border-sm\" role=\"status\" aria-hidden=\"true\"></span> Issuing...\n              </button>\n            : <button className = \"btn btn-lg btn-block btn-outline-pink mb-4\" onClick = {(e) => this.handleClick(e)}>\n                { this.state.issued  ? 'View Certification' : 'Issue Real Certification'}\n              </button>\n          }\n          \n        </form>\n      </div>\n    );\n  }\n}\n\nconst padTo32byte = (hex) => `0x${hex.padStart(64, '0')}`\n\nexport default IssuePage;\n","import React, { Component } from \"react\";\nimport { BrowserRouter as Router, Switch, Route } from \"react-router-dom\";\n\nimport Home from './Home'\nimport Certification from './Certification'\nimport IssuePage from './IssuePage'\n\nclass App extends Component {\n  render() {\n    return (\n      <Router>\n        <Switch>\n          <Route path=\"/certification/sample/:bride/:groom/\" component={Certification}/>\n          <Route path=\"/certification/:id/:txHash\" component={Certification}/>\n          <Route path=\"/issue/:bride/:groom/\" component={IssuePage}/>\n          <Route path=\"/\" component={Home}/>\n        </Switch>\n      </Router>\n    )\n  }\n}\n\nexport default App;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport App from './components/App';\n\nReactDOM.render(<App />, document.getElementById('root'));\n"],"sourceRoot":""}